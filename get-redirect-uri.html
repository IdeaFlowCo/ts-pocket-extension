<!DOCTYPE html>
<html>
<head>
  <title>Get Redirect URI</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
    }
    .uri-display {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      word-break: break-all;
      margin: 20px 0;
    }
    .instructions {
      line-height: 1.6;
    }
    button {
      background: #0066cc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background: #0052a3;
    }
  </style>
</head>
<body>
  <h1>TsPocket Extension Setup</h1>
  
  <div class="instructions">
    <h2>Your Extension's Redirect URI:</h2>
    <div id="redirectUri" class="uri-display">Loading...</div>
    
    <button id="copyBtn">Copy to Clipboard</button>
    
    <h2>Setup Instructions:</h2>
    <ol>
      <li>Copy the redirect URI above</li>
      <li>Go to your Auth0 dashboard</li>
      <li>Navigate to Applications â†’ TsPocket (or your app name)</li>
      <li>In the "Allowed Callback URLs" field, add the copied URI</li>
      <li>Also add it to "Allowed Web Origins" if that field exists</li>
      <li>Save the changes</li>
      <li>Try logging in again through the extension</li>
    </ol>
    
    <h3>Troubleshooting:</h3>
    <ul>
      <li>Make sure the extension is loaded in Chrome (chrome://extensions)</li>
      <li>The redirect URI will change if you reload the extension</li>
      <li>If you see a different URI in the error, use that one instead</li>
    </ul>
  </div>
  
  <script>
    // Get the redirect URI
    if (chrome.identity) {
      const redirectUri = chrome.identity.getRedirectURL();
      document.getElementById('redirectUri').textContent = redirectUri;
      
      document.getElementById('copyBtn').addEventListener('click', () => {
        navigator.clipboard.writeText(redirectUri).then(() => {
          const btn = document.getElementById('copyBtn');
          btn.textContent = 'Copied!';
          setTimeout(() => {
            btn.textContent = 'Copy to Clipboard';
          }, 2000);
        });
      });
    } else {
      document.getElementById('redirectUri').textContent = 'Please open this page from the extension (click on a link in popup or options page)';
    }
  </script>
</body>
</html>